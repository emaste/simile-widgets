<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="data-structure.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>data-structure.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'data-structure.js'<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="Timegrid/EventIndex.html">Timegrid.EventIndex</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="Timegrid/EventIndex/_AllIterator.html">Timegrid.EventIndex._AllIterator</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="Timegrid/EventIndex/_Iterator.html">Timegrid.EventIndex._Iterator</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="Timegrid/SortedArray.html">Timegrid.SortedArray</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/*==================================================
 *  Sorted Array
 *==================================================
 */</span>

Timegrid.SortedArray = <span class="reserved">function</span>(compare, initialArray) {
    <span class="reserved">this</span>._a = (initialArray instanceof Array) ? initialArray : [];
    <span class="reserved">this</span>._compare = compare;
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.add = <span class="reserved">function</span>(elmt) {
    var sa = <span class="reserved">this</span>;
    var index = <span class="reserved">this</span>.find(<span class="reserved">function</span>(elmt2) {
        <span class="reserved">return</span> sa._compare(elmt2, elmt);
    });
    
    <span class="reserved">if</span> (index &lt; <span class="reserved">this</span>._a.length) {
        <span class="reserved">this</span>._a.splice(index, 0, elmt);
    } <span class="reserved">else</span> {
        <span class="reserved">this</span>._a.push(elmt);
    }
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.remove = <span class="reserved">function</span>(elmt) {
    var sa = <span class="reserved">this</span>;
    var index = <span class="reserved">this</span>.find(<span class="reserved">function</span>(elmt2) {
        <span class="reserved">return</span> sa._compare(elmt2, elmt);
    });
    
    <span class="reserved">while</span> (index &lt; <span class="reserved">this</span>._a.length &amp;&amp; <span class="reserved">this</span>._compare(<span class="reserved">this</span>._a[index], elmt) == 0) {
        <span class="reserved">if</span> (<span class="reserved">this</span>._a[index] == elmt) {
            <span class="reserved">this</span>._a.splice(index, 1);
            <span class="reserved">return</span> true;
        } <span class="reserved">else</span> {
            index++;
        }
    }
    <span class="reserved">return</span> false;
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.removeAll = <span class="reserved">function</span>() {
    <span class="reserved">this</span>._a = [];
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.elementAt = <span class="reserved">function</span>(index) {
    <span class="reserved">return</span> <span class="reserved">this</span>._a[index];
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.length = <span class="reserved">function</span>() {
    <span class="reserved">return</span> <span class="reserved">this</span>._a.length;
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.find = <span class="reserved">function</span>(compare) {
    var a = 0;
    var b = <span class="reserved">this</span>._a.length;
    
    <span class="reserved">while</span> (a &lt; b) {
        var mid = Math.floor((a + b) / 2);
        var c = compare(<span class="reserved">this</span>._a[mid]);
        <span class="reserved">if</span> (mid == a) {
            <span class="reserved">return</span> c &lt; 0 ? a+1 : a;
        } <span class="reserved">else</span> <span class="reserved">if</span> (c &lt; 0) {
            a = mid;
        } <span class="reserved">else</span> {
            b = mid;
        }
    }
    <span class="reserved">return</span> a;
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.getFirst = <span class="reserved">function</span>() {
    <span class="reserved">return</span> (<span class="reserved">this</span>._a.length &gt; 0) ? <span class="reserved">this</span>._a[0] : null;
};

Timegrid.SortedArray.<span class="reserved">prototype</span>.getLast = <span class="reserved">function</span>() {
    <span class="reserved">return</span> (<span class="reserved">this</span>._a.length &gt; 0) ? <span class="reserved">this</span>._a[<span class="reserved">this</span>._a.length - 1] : null;
};

<span class="comment">/*==================================================
 *  Event Index
 *==================================================
 */</span>

Timegrid.EventIndex = <span class="reserved">function</span>(unit) {
    var eventIndex = <span class="reserved">this</span>;
    
    <span class="reserved">this</span>._unit = (unit != null) ? unit : Timegrid.NativeDateUnit;
    <span class="reserved">this</span>._events = new Timegrid.SortedArray(
        <span class="reserved">function</span>(event1, event2) {
            <span class="reserved">return</span> eventIndex._unit.compare(event1.getStart(), event2.getStart());
        }
    );
    <span class="reserved">this</span>._indexed = true;
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.getUnit = <span class="reserved">function</span>() {
    <span class="reserved">return</span> <span class="reserved">this</span>._unit;
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.add = <span class="reserved">function</span>(evt) {
    <span class="reserved">this</span>._events.add(evt);
    <span class="reserved">this</span>._indexed = false;
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.removeAll = <span class="reserved">function</span>() {
    <span class="reserved">this</span>._events.removeAll();
    <span class="reserved">this</span>._indexed = false;
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.getCount = <span class="reserved">function</span>() {
    <span class="reserved">return</span> <span class="reserved">this</span>._events.length();
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.getIterator = <span class="reserved">function</span>(startDate, endDate) {
    <span class="reserved">if</span> (!<span class="reserved">this</span>._indexed) {
        <span class="reserved">this</span>._index();
    }
    <span class="reserved">return</span> new Timegrid.EventIndex._Iterator(<span class="reserved">this</span>._events, startDate, endDate, <span class="reserved">this</span>._unit);
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.getAllIterator = <span class="reserved">function</span>() {
    <span class="reserved">return</span> new Timegrid.EventIndex._AllIterator(<span class="reserved">this</span>._events);
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.getEarliestDate = <span class="reserved">function</span>() {
    var evt = <span class="reserved">this</span>._events.getFirst();
    <span class="reserved">return</span> (evt == null) ? null : evt.getStart();
};

Timegrid.EventIndex.<span class="reserved">prototype</span>.getLatestDate = <span class="reserved">function</span>() {
    var evt = <span class="reserved">this</span>._events.getLast();
    <span class="reserved">if</span> (evt == null) {
        <span class="reserved">return</span> null;
    }
    
    <span class="reserved">if</span> (!<span class="reserved">this</span>._indexed) {
        <span class="reserved">this</span>._index();
    }
    
    var index = evt._earliestOverlapIndex;
    var date = <span class="reserved">this</span>._events.elementAt(index).getEnd();
    <span class="reserved">for</span> (var i = index + 1; i &lt; <span class="reserved">this</span>._events.length(); i++) {
        date = <span class="reserved">this</span>._unit.later(date, <span class="reserved">this</span>._events.elementAt(i).getEnd());
    }
    
    <span class="reserved">return</span> date;
};

Timegrid.EventIndex.<span class="reserved">prototype</span>._index = <span class="reserved">function</span>() {
    <span class="comment">/*
     *  For each event, we want to find the earliest preceding
     *  event that overlaps with it, if any.
     */</span>
    
    var l = <span class="reserved">this</span>._events.length();
    <span class="reserved">for</span> (var i = 0; i &lt; l; i++) {
        var evt = <span class="reserved">this</span>._events.elementAt(i);
        evt._earliestOverlapIndex = i;
    }
    
    var toIndex = 1;
    <span class="reserved">for</span> (var i = 0; i &lt; l; i++) {
        var evt = <span class="reserved">this</span>._events.elementAt(i);
        var end = evt.getEnd();
        
        toIndex = Math.max(toIndex, i + 1);
        <span class="reserved">while</span> (toIndex &lt; l) {
            var evt2 = <span class="reserved">this</span>._events.elementAt(toIndex);
            var start2 = evt2.getStart();
            
            <span class="reserved">if</span> (<span class="reserved">this</span>._unit.compare(start2, end) &lt; 0) {
                evt2._earliestOverlapIndex = i;
                toIndex++;
            } <span class="reserved">else</span> {
                break;
            }
        }
    }
    <span class="reserved">this</span>._indexed = true;
};

Timegrid.EventIndex._Iterator = <span class="reserved">function</span>(events, startDate, endDate, unit) {
    <span class="reserved">this</span>._events = events;
    <span class="reserved">this</span>._startDate = startDate;
    <span class="reserved">this</span>._endDate = endDate;
    <span class="reserved">this</span>._unit = unit;
    
    <span class="reserved">this</span>._currentIndex = events.find(<span class="reserved">function</span>(evt) {
        <span class="reserved">return</span> unit.compare(evt.getStart(), startDate);
    });
    <span class="reserved">if</span> (<span class="reserved">this</span>._currentIndex - 1 &gt;= 0) {
        <span class="reserved">this</span>._currentIndex = <span class="reserved">this</span>._events.elementAt(<span class="reserved">this</span>._currentIndex - 1)._earliestOverlapIndex;
    }
    <span class="reserved">this</span>._currentIndex--;
    
    <span class="reserved">this</span>._maxIndex = events.find(<span class="reserved">function</span>(evt) {
        <span class="reserved">return</span> unit.compare(evt.getStart(), endDate);
    });
    
    <span class="reserved">this</span>._hasNext = false;
    <span class="reserved">this</span>._next = null;
    <span class="reserved">this</span>._findNext();
};

Timegrid.EventIndex._Iterator.<span class="reserved">prototype</span> = {
    hasNext: <span class="reserved">function</span>() { <span class="reserved">return</span> <span class="reserved">this</span>._hasNext; },
    next: <span class="reserved">function</span>() {
        <span class="reserved">if</span> (<span class="reserved">this</span>._hasNext) {
            var next = <span class="reserved">this</span>._next;
            <span class="reserved">this</span>._findNext();
            
            <span class="reserved">return</span> next;
        } <span class="reserved">else</span> {
            <span class="reserved">return</span> null;
        }
    },
    _findNext: <span class="reserved">function</span>() {
        var unit = <span class="reserved">this</span>._unit;
        <span class="reserved">while</span> ((++<span class="reserved">this</span>._currentIndex) &lt; <span class="reserved">this</span>._maxIndex) {
            var evt = <span class="reserved">this</span>._events.elementAt(<span class="reserved">this</span>._currentIndex);
            <span class="reserved">if</span> (unit.compare(evt.getStart(), <span class="reserved">this</span>._endDate) &lt; 0 &amp;&amp;
                unit.compare(evt.getEnd(), <span class="reserved">this</span>._startDate) &gt; 0) {
                
                <span class="reserved">this</span>._next = evt;
                <span class="reserved">this</span>._hasNext = true;
                <span class="reserved">return</span>;
            }
        }
        <span class="reserved">this</span>._next = null;
        <span class="reserved">this</span>._hasNext = false;
    }
};

Timegrid.EventIndex._AllIterator = <span class="reserved">function</span>(events) {
    <span class="reserved">this</span>._events = events;
    <span class="reserved">this</span>._index = 0;
};

Timegrid.EventIndex._AllIterator.<span class="reserved">prototype</span> = {
    hasNext: <span class="reserved">function</span>() {
        <span class="reserved">return</span> <span class="reserved">this</span>._index &lt; <span class="reserved">this</span>._events.length();
    },
    next: <span class="reserved">function</span>() {
        <span class="reserved">return</span> <span class="reserved">this</span>._index &lt; <span class="reserved">this</span>._events.length() ?
            <span class="reserved">this</span>._events.elementAt(<span class="reserved">this</span>._index++) : null;
    }
};</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Fri Jun  8 12:02:42 2007</div>
</body>
</html>
